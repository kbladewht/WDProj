ZDK.define("module.slide",function(){var a=function(a){return this instanceof arguments.callee?void this.entry(a):new arguments.callee(a)};return a.prototype={entry:function(a){var b=this.opche=$.extend({target:null,item:"li",prev:null,next:null,step:1,size:0,time:200,timeout:0,loop:!0,path:!1,moreLink:!1,isRound:!1,oninited:null},a);this.target=$(b.target),this.target.children().length<2||(this.width=this.target.parent().outerWidth(this),this.itemList="string"==typeof b.item?this.target.find(b.item):b.item,this.number=this.itemList.length,this.perWidth=this.itemList.eq(0).outerWidth(!0),this.perHeight=this.itemList.eq(0).outerHeight(!0),this.size=b.size||Math.floor(this.width/this.perWidth),this.step=1==this.size||b.step>this.size?1:b.step,this.hv=b.path?"marginTop":"marginLeft",this.index=this.oindex=0,this.maxIndex=1==this.size?this.number-1:this.number-this.size,this.init(),this.bind(),this.autoPlay(),this.opche.oninited&&this.opche.oninited(this))},init:function(){if(1!==this.size){var a=this.opche.path?this.perWidth:this.size*this.perWidth,b=this.opche.path?this.size*this.perHeight:this.perHeight;if(this.opche.isRound&&this.size<this.number){var c=-(this.number-this.size)*(this.opche.pache?this.perWidth:this.perHeight);this.target.prepend(this.itemList.slice(this.size).clone()).append(this.itemList.slice(0,this.size).clone()),this.number*=2,this.maxIndex=this.number-this.size,this.index=this.number/2-this.size,this.target.css(this.hv,c)}this.scroll=$("<div></div>").css({position:"relative",width:a,height:b,overflow:"hidden"}).appendTo(this.target.parent()).append(this.target),!this.opche.path&&this.target.css("width",this.number*this.perWidth+100)}else this.target.css({position:"relative",overflow:"hidden",padding:"0",width:this.perWidth,height:this.perHeight}),this.itemList.css({position:"absolute",left:this.perWidth+100,top:this.perHeight+100}),this.itemList.eq(0).css({left:0,top:0})},bind:function(){var a=this,b=this.opche;if(b.moreLink){if(b.prev&&$(b.prev).click(function(){var c=$(b.next);c[0].clickCount=0,c.hasClass("channel-bar-slide-more")&&c.removeClass("channel-bar-slide-more").attr("data-more",c.attr("href")).attr("href","###").attr("target","").html('<i class="iconfont">&#xe822;</i>'),a.prev()}),b.next){var c=$(b.next);c[0].clickCount=0,c.click(function(b){2==c[0].clickCount&&($(this).addClass("channel-bar-slide-more").attr("href",$(this).attr("data-more")).html("查看更多交易").attr("target","_blank"),b.preventDefault()),c[0].clickCount++,a.next()})}}else b.prev&&$(b.prev).click(function(){a.prev()}),b.next&&$(b.next).click(function(){a.next()})},autoPlay:function(a){var b=this;return a?b.timer&&clearInterval(b.timer):b.opche.timeout&&(b.timer=setInterval(function(){b.go(b.index+=b.step)},b.opche.timeout)),!0},prev:function(){this.playing||((this.index-=this.step)<0&&0!=this.oindex&&(this.index=0),this.go(this.index,this.autoPlay(!0)),this.trigger("prev",{target:this,index:this.index,oindex:this.oindex}))},next:function(){this.playing||((this.index+=this.step)>this.maxIndex&&this.oindex!=this.maxIndex&&(this.index=this.maxIndex),this.go(this.index,this.autoPlay(!0)),this.trigger("next",{target:this,index:this.index,oindex:this.oindex}))},go:function(a,b){var c=this;this.playing||((this.index=a)<0?this.opche.isRound?(this.target.css(this.hv,-this.number/2*this.perHeight),this.index=this.number/2-this.size):this.index=this.opche.loop?this.maxIndex:0:this.index>this.maxIndex&&(this.opche.isRound?(this.target.css(this.hv,-(this.number/2-this.size)*this.perHeight),this.index=this.number/2):this.index=this.opche.loop?0:this.maxIndex),c.size<c.number&&this.play(b))},play:function(a){var b=this,c={};if("number"==typeof a){if(a==this.index)return;return b.go(a,this.autoPlay(!0))}if(b.playing=!0,b.trigger("play",{target:b,index:b.index,oindex:b.oindex}),1==b.size){var d=b.direction();return b.itemList.eq(b.oindex).animate({left:d[0].l,top:d[0].t},"slow",function(){a&&b.autoPlay(),b.oindex=b.index,b.playing=!1}),b.itemList.eq(b.index).css({left:d[1].l,top:d[1].t}).animate({left:0,top:0},b.opche.time)}b.opche.path?c.marginTop=-b.index*b.perHeight:c.marginLeft=-b.index*b.perWidth,b.target.animate(c,b.opche.time,function(){a&&b.autoPlay(),b.playing=!1,b.oindex=b.index})},direction:function(){var a=this.perHeight,b=this.perWidth,c=this.opche.path;switch(this.path="number"==typeof c?1+8*Math.random():this.oindex>this.index?c?2:4:c?1:3,this.path){case 1:return[{t:-a},{l:0,t:a}];case 2:return[{t:a},{l:0,t:-a}];case 3:return[{l:-b},{t:0,l:b}];case 4:return[{l:b},{t:0,l:-b}];case 5:return[{l:-b,t:-a},{t:a,l:b}];case 6:return[{l:b,t:-a},{t:a,l:-b}];case 7:return[{l:-b,t:a},{t:-a,l:b}];default:return[{l:b,t:a},{t:-a,l:-b}]}}},ZDK.procopy(a,ZDK.EventEmitter)});